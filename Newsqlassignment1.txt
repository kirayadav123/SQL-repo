CREATE DATABASE Assignment_01

CREATE TABLE CUSTOMER 
(
Id INTEGER PRIMARY KEY,
FirstName nVARCHAR(40) NOT NULL,
LastName nVARCHAR(40),
City nVARCHAR(40),
Country VARCHAR(40),
Phone nVARCHAR(40)
);
INSERT INTO CUSTOMER 
VALUES(01,'Ranya','Jha','Punjab','India','9955466678')
INSERT INTO CUSTOMER
VALUES(02,'Akash', 'Verma','Hazaribagh','India','82447688898')
INSERT INTO CUSTOMER 
VALUES(03,'Nidhi','Chaudhery','Ramgarh','India','8989675645')
INSERT INTO CUSTOMER 
VALUES(04,'Ram','Singh','Tamil Nadu','India','788894567')
INSERT INTO CUSTOMER 
VALUES(05,'Anil','Singh','Hyderabad','India','8967345623')
INSERT INTO CUSTOMER 
VALUES(06,'Priyanka','Singh','Hyderabad','America','7767345623')
INSERT INTO CUSTOMER
VALUES(07,'Gudiya','Yadav','Kanpur','London','8989345678')
CREATE TABLE ORDER_CUST
( Order_Id INTEGER PRIMARY KEY,
  OrderDate DATETIME NOT NULL,
  OrderNumber nVARCHAR(10),
  CustomerId INTEGER ,
  TotalAmount DECIMAL(12,2)
);
INSERT INTO ORDER_CUST
VALUES(11,25-11-2022,'0050987',01,2003.78)
INSERT INTO ORDER_CUST
VALUES(12,22-9-2022,'3400659',02,3004.67)
INSERT INTO ORDER_CUST 
VALUES(13,18-7-2022,'353234',02,2045.78)
INSERT INTO ORDER_CUST 
VALUES(14,16-6-2022,'7577700',03,5067.00)

CREATE TABLE ORDERITEM1
(
Id INTEGER PRIMARY KEY,
OrderId1 INTEGER,
ProductId INTEGER,
UnitPrice DECIMAL(12,2),
QUANTITY INTEGER
);

INSERT INTO ORDERITEM
VALUES(121,11,231,10.12,5);
INSERT INTO ORDERITEM 
VALUES(122,12,232,12.78,7)
INSERT INTO ORDERITEM 
VALUES(123,13,233,23.56,2)
INSERT INTO ORDERITEM 
VALUES(124,13,234,25.00,3);
SELECT * FROM ORDERITEM;


CREATE TABLE PRODUCT
(
Id INTEGER PRIMARY KEY,
ProductName nVARCHAR(50),
UnitPrice DECIMAL(12,2),
Package nVARCHAR(30),
IsDiscontinued BIT
);
INSERT INTO PRODUCT 
VALUES(231,'choclate',10.12,'Polythene bag','True')
INSERT INTO PRODUCT 
VALUES(232,'Biscuit',12.78,'Plastic','True')
INSERT INTO PRODUCT 
VALUES(233,'toffiee',23.56,'Polythene','False')
INSERT INTO PRODUCT 
VALUES(234,'Parle G',25.00,'Jute Bag','True')


CREATE TABLE Employee
(emp_name varchar(50) not null,
Manager_name varchar(50) not null, 
Dept_name varchar(50) not null,Rating int,
Comp_Ship_Name nvarchar(50))
INSERT INTO CUSTOMER 
VALUES(01,'Raesh shingh','Mhima mishra','','Marketing','8','Zomoto1')
INSERT INTO CUSTOMER
VALUES(02,'Akash', 'Rohan Verma','Finance','8','Domonias2')
INSERT INTO CUSTOMER 
VALUES(03,'Nikita Verma','Reshma Chaudhery','Sales','9','pizza hut4')


ALTER TABLE ORDERITEM
ADD CONSTRAINT FK_ProductId FOREIGN KEY 
(productId) REFERENCES Product(Id);
SELECT * FROM CUSTOMER;
SELECT COUNTRY FROM CUSTOMER 
WHERE Country like '[A_I]%' ;
SELECT COUNTRY FROM CUSTOMER 
WHERE CharIndex('A',Country)=1  OR CHARINDEX('I',COUNTRY)=1;
SELECT * FROM CUSTOMER 
WHERE FirstName LIKE '__I%';

--Assignment 02 

SELECT * FROM CUSTOMER
WHERE Country='Germany';

SELECT FirstName , LastName FROM CUSTOMER;

--Query 2 


SELECT * FROM CUSTOMER
WHERE FirstName LIKE '_U%';

SELECT * FROM ORDERITEM
WHERE UnitPrice>10 And UnitPrice<20;

SELECT OrderDate FROM ORDER_CUST
GROUP BY OrderDate;



SELECT * FROM ORDER_CUST WHERE OrderDate BETWEEN 10-10-2022 and 12-10-2022;
--Query 3


SELECT * FROM PRODUCT;
SELECT ProductName FROM PRODUCT
WHERE ProductName='Exotic Liquids'

--Query 4
SELECT AVG(QUANTITY) 
FROM ORDERITEM;
--Query 5

SELECT * FROM Employee;
SELECT emp_name,Manager_name FROM Employee;




--Assignment 3 
SELECT * FROM CUSTOMER;
SELECT * FROM ORDER_CUST;
 
SELECT Id, FirstName,LastName,City,Country,phone, Order_Id,OrderDate,OrderNumber,TotalAmount 
From CUSTOMER INNER JOIN ORDER_CUST
ON CUSTOMER.Id=ORDER_CUST.CustomerId WHERE CUSTOMER.Phone='9955466678';

SELECT * FROM PRODUCT;

SELECT * FROM PRODUCT WHERE
ProductName='Seafood';

SELECT *  FROM CUSTOMER INNER JOIN ORDER_CUST
ON CUSTOMER.Id=ORDER_CUST.CustomerId 
WHERE CUSTOMER.Country 
NOT IN (SELECT Country FROM CUSTOMER WHERE Country='London'); 


SELECT * FROM ORDERITEM
INNER JOIN PRODUCT ON 
ORDERITEM.ProductId=PRODUCT.Id WHERE PRODUCT.ProductName='chai';

SELECT * FROM EMPLOYEE;
ALTER TABLE EMPLOYEE
ADD Dept_name nVARCHAR(50);
ALTER TABLE EMPLOYEE
ADD Rating Integer;
SELECT Emp_name, Dept_name,Rating 
FROM EMPLOYEE WHERE emp_name='Riya'; 



ALTER TABLE PRODUCT 
ADD Comp_Ship_Name nVARCHAR(40);

--Assignment4

SELECT Comp_Shipping_Name, TotalAmount As TotalPrice
FROM ORDER_CUST INNER JOIN ORDERITEM 
ON ORDER_CUST.Order_Id=ORDERITEM.OrderId1
INNER JOIN PRODUCT ON 
ORDERITEM.ProductId=PRODUCT.Id
WHERE PRoductName='Exotic Liquid' AND TotalAmount>50; 

--query2


--query 4
SELECT  ProductName, ORDERITEM.UnitPrice,
     MAX(TotalAmount) AS [Most Expensive],
     MIN(TotalAmount) As [Least Expensive]
	 
FROM ORDER_CUST INNER JOIN ORDERITEM ON 
ORDER_CUST.Order_Id=ORDERITEM.OrderId1
INNER JOIN PRODUCT ON
ORDERITEM.ProductId=PRODUCT.Id
GROUP BY ProductName,ORDERITEM.UnitPrice;	 






SELECT * FROM CUSTOMER;
SELECT * FROM ORDER_CUST;
SELECT * FROM ORDERITEM;
SELECT * FROM PRODUCT;
--Query8
SELECT Id, FirstName,LastName,CIty,Country,Phone,Order_Id,OrderDate 
FROM CUSTOMER INNER JOIN ORDER_CUST ON 
CUSTOMER.Id=ORDER_CUST.CustomerId;

--Query 9
SELECT FirstName As CustomerName, Quantity As Maximum_No_Order 
FROM CUSTOMER INNER JOIN ORDER_CUST ON 
CUSTOMER.Id=ORDER_CUST.CustomerId 
INNER JOIN ORDERITEM ON 
ORDER_CUST.Order_Id=ORDERITEM.OrderId1 
WHERE ORDERITEM.QUANTITY =(SELECT MAX(QUANTITY) FROM ORDERITEM)

--Query 10
SELECT Id FROM CUSTOMER
WHERE Firstname like %RA%


























